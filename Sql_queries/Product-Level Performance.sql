# Product-Level Performance 

-- Top 10 Best-Selling Product by Quantity:

SELECT 
  p.product_name,
  SUM(s.quantity) AS total_quantity_sold
FROM `intro-to-bq-465716.wisdom_pets.sales` s
JOIN `intro-to-bq-465716.wisdom_pets.products` p
  ON s.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity_sold DESC
LIMIT 10;

--------------------------------------------------

-- Revenue Generated By Product Category:

SELECT 
  p.category_name,
  ROUND(SUM(s.total_amount),0) AS category_revenue
FROM `intro-to-bq-465716.wisdom_pets.sales` s
JOIN `intro-to-bq-465716.wisdom_pets.products` p 
ON s.product_id = p.product_id
GROUP BY p.category_name
ORDER BY category_revenue DESC;


--------------------------------------------------

-- Product Rating Affect Sales: 

SELECT 
  p.product_name,
  p.rating,
  ROUND(SUM(s.total_amount),0) AS total_sales
FROM `intro-to-bq-465716.wisdom_pets.sales` s
JOIN `intro-to-bq-465716.wisdom_pets.products` p ON s.product_id = p.product_id
WHERE p.rating IS NOT NULL
GROUP BY p.product_name, p.rating
ORDER BY total_sales DESC;

---------------------------------------------------

-- Avg Selling Price Per Unit By Product:

SELECT 
  p.product_name,
  ROUND(SUM(s.total_amount) / NULLIF(SUM(s.quantity), 0), 2) AS avg_selling_price,
  p.retail_price AS listed_price,
  ROUND(p.retail_price - ROUND(SUM(s.total_amount) / NULLIF(SUM(s.quantity), 0), 2),2) AS price_diff
FROM `intro-to-bq-465716.wisdom_pets.sales` s
JOIN `intro-to-bq-465716.wisdom_pets.products` p 
  ON s.product_id = p.product_id
GROUP BY p.product_name, p.retail_price
ORDER BY price_diff DESC;










